# Pythonの変換ツールを作成してください。

## ツール概要

このツールは、template.docxをテンプレートとして、指定ファイル（以下、変換元）のヘッダー、フッターと表紙を変更します。

### ファイル名

top-page.py

### コマンドラインの例

python top-page.py <変換元ファイル名> --DocCode D-001 --DocName ソフトウェア要求仕様書 --Version 1.0

### 引数

template.docxファイルの中、`$`で始まる文字列は、変数となります。
- $DocCode (default:`D-000`)
- $DocName (default:`仕様書`)
- $Version (default:`1.0`)

### 処理

#### 1. 原則
**ヘッダー、フッターと表紙(1ページ目)以外の内容は変更しないでください。**

#### 2. 変換先ファイルの場所

変換元ファイル所在のフォルダに、`changed`フォルダーがなければ作成し、変換したファイルはそこにおく。

#### 3. ヘッダー
 - ヘッダーをtemplateに合わせて変更
 - `表紙`と`表紙以外`のヘッダーは同じように見えますが、別設定の必要があるのでご注意ください
 - `Wordバグ対応`: ヘッダー変換後に、`販売名`の文字の前に必ず`TAB文字`が混入される。それを強制削除してください。

#### 4. フッター
 - フッターには `-1-`の書式でページ番号を表示する
 - 表紙ページは、フッターを表示しない
 - ページ番号は0からです（Wordの設定）

##### 4.1 フッター実装の技術的注意
 - フッターにはPAGEフィールドのみを配置（余計なテキストは不要）
 - `-1-`形式はWordの「ページ番号書式」機能で実現：`w:pgNumType`要素で`w:fmt="numberInDash"`を設定
 - 開始番号は`w:start="0"`で設定

#### 5. templateの表紙をコピーし、変換元の表紙を入れ替える。

 - 最初のテーブルの１列目の幅は45mmにする、2列目の幅を135mmにする。
 - **厳密：** templateの表示にある内容は、漏れないでください。
 - **厳密：** templateの表紙の書式（フォント、フォントサイズ、テーブルのすべてのプロパティ）全部保持しなければならない

##### 5.1 テーブル列幅設定の技術的注意（実装時の知見）

複数列の幅を同時に設定する場合、以下の設定が必須：

1. **`tblLayout`を`fixed`に設定** - テーブルレイアウトを固定モードにする
   - デフォルトは`auto`（自動調整）で、Wordがセル幅を自動計算してしまう
   - `fixed`にしないと、複数列を変更した際に設定値が無視される

2. **`tblW`を固定幅に設定** - テーブル全体の幅を明示的に指定
   - `type="dxa"`（twips単位）で合計幅を設定
   - 例: 45mm + 135mm = 180mm → 約10205 twips

3. **各セルの`tcW`と`gridCol`を設定** - 個別のセル幅とグリッド定義

```xml
<!-- tblPrに追加 -->
<w:tblLayout w:type="fixed"/>
<w:tblW w:w="10205" w:type="dxa"/>
```

**原因**: 1列だけ変更すると動作するが、2列とも変更すると両方効かない現象は、`auto`モードでWordが自動調整してしまうため。

### 試験・修正

#### 1.テスト実行

テスト用実行の例：

```bash
python top-page.py "sample/21GXP-D-001 ソフトウェア要求仕様書.docx" --DocCode D-001 --DocName ソフトウェア要求仕様書 --Version 1.0
```

#### 2. 試験

実行できたら、下記試験を実施する
- ファイルが生成されたことを確認
- ファイルのXML構造を抽出し、要求されたポイントはすべてあっていることを確認する
- 要求に満たしていない場合、調査・修正・試験を繰り返してください。

